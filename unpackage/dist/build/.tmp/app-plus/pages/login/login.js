(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/login/login"],{"54e6":function(t,e,n){"use strict";var o,a=function(){var t=this,e=t.$createElement;t._self._c;t._isMounted||(t.e0=function(e){!t.safety.state&&t.fnGetPhoneCode()})},s=[];n.d(e,"b",function(){return a}),n.d(e,"c",function(){return s}),n.d(e,"a",function(){return o})},7014:function(t,e,n){"use strict";n.r(e);var o=n("54e6"),a=n("ea7c");for(var s in a)"default"!==s&&function(t){n.d(e,t,function(){return a[t]})}(s);n("d05c");var i,c=n("f0c5"),u=Object(c["a"])(a["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],i);e["default"]=u.exports},b679:function(t,e,n){"use strict";(function(t){n("65f7"),n("921b");o(n("66fd"));var e=o(n("7014"));function o(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("6e42")["createPage"])},d05c:function(t,e,n){"use strict";var o=n("e9ad"),a=n.n(o);a.a},e9ad:function(t,e,n){},e9e7:function(t,e,n){"use strict";(function(t,o){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=n("2f62"),s=i(n("9f9e"));function i(t){return t&&t.__esModule?t:{default:t}}function c(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},o=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),o.forEach(function(e){u(t,e,n[e])})}return t}function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var r=function(){return n.e("components/cmd-nav-bar/cmd-nav-bar").then(n.bind(null,"36f6"))},l=function(){return n.e("components/cmd-page-body/cmd-page-body").then(n.bind(null,"7d7d"))},f=function(){return n.e("components/cmd-transition/cmd-transition").then(n.bind(null,"626f"))},d=function(){return n.e("components/cmd-input/cmd-input").then(n.bind(null,"3dc4"))},h={components:{cmdNavBar:r,cmdPageBody:l,cmdTransition:f,cmdInput:d},computed:(0,a.mapState)(["forcedLogin","serverUrl","user"]),data:function(){return{account:{username:"",password:""},usernameReg:/^[A-Za-z0-9]+$/,passwordReg:/^\w+$/,loginAccount:!1,mobile:{phone:"",code:""},phoneReg:/^[1](([3][0-9])|([4][5-9])|([5][0-3,5-9])|([6][5,6])|([7][0-8])|([8][0-9])|([9][1,8,9]))[0-9]{8}$/,loginMobile:!1,safety:{time:60,state:!1,interval:""},status:!0}},watch:{mobile:{handler:function(t){this.phoneReg.test(t.phone)&&6===t.code.length?this.loginMobile=!0:this.loginMobile=!1},deep:!0},account:{handler:function(t){this.usernameReg.test(t.username)&&t.username.length>=8&&this.passwordReg.test(t.password)&&t.password.length>=8?this.loginAccount=!0:this.loginAccount=!1},deep:!0}},methods:c({},(0,a.mapMutations)(["login","updateUser","setToken"]),{toMain:function(e){this.login(e),this.forcedLogin?t.reLaunch({url:"../main/main"}):t.navigateBack()},fnLogin:function(){var e=this;if(this.status){console.log(o(JSON.stringify(this.mobile)," at pages\\login\\login.vue:164"));var n=this.mobile,a=this,i={};i.url="/user/login/phone/"+n.phone+"/"+n.code,i.data={},s.default.postWithNoStatus(i).then(function(n){if(n.data.status){t.showToast({icon:"success",title:"登录成功"});var s=n.data.message;try{console.log(o("手机登录：token="+s," at pages\\login\\login.vue:180")),t.setStorageSync("token",s),a.updateUser(n.data.data),a.setToken(s),e.toMain(n.data.data.username)}catch(i){t.showToast({icon:"none",title:"登陆失败：存入token失败"})}}else t.showToast({icon:"none",title:"登陆失败："+n.data.data.message})},function(e){t.showToast({icon:"none",title:"登陆失败:"+e})})}else{var c=this.account,u=this,r={url:"/user/login/account"};r.data=c,s.default.postWithNoStatus(r).then(function(n){if(n.data.status){t.showToast({icon:"success",title:"登录成功"});var a=n.data.message;try{console.log(o("账号登陆：token="+a," at pages\\login\\login.vue:275")),t.setStorageSync("token",a),u.updateUser(n.data.data),u.setToken(a),e.toMain(n.data.data.username)}catch(s){t.showToast({icon:"none",title:"登陆失败:存入token失败"})}}else t.showToast({icon:"none",title:"登陆失败:"+n.data.message})},function(e){t.showToast({icon:"none",title:"登陆失败:"+e})})}},fnGetPhoneCode:function(){var e=this;this.phoneReg.test(this.mobile.phone)?t.showToast({title:"正在发送验证码",icon:"loading",success:function(){var n={};n.url="/message/getYanzhengma/"+e.mobile.phone+"/login",s.default.get(n).then(function(n){t.showToast({icon:"none",title:"发送成功"}),e.safety.state=!0,e.safety.interval=setInterval(function(){e.safety.time--<=0&&(e.safety.time=60,e.safety.state=!1,clearInterval(e.safety.interval))},1e3)},function(e){t.showToast({icon:"none",title:"发送失败:"+e})})}}):t.showToast({title:"手机号不正确",icon:"none"})},fnChangeStatus:function(t){this.mobile={phone:"",code:""},this.loginMobile=!1,this.account={username:"",password:""},this.loginAccount=!1,clearInterval(this.safety.interval),this.safety.time=60,this.safety.state=!1,t||(this.status=!this.status)},fnRegisterWin:function(){t.navigateTo({url:"/pages/user/register/register"}),this.fnChangeStatus(!0)}}),beforeDestroy:function(){clearInterval(this.safety.interval)}};e.default=h}).call(this,n("6e42")["default"],n("0de9")["default"])},ea7c:function(t,e,n){"use strict";n.r(e);var o=n("e9e7"),a=n.n(o);for(var s in o)"default"!==s&&function(t){n.d(e,t,function(){return o[t]})}(s);e["default"]=a.a}},[["b679","common/runtime","common/vendor"]]]);